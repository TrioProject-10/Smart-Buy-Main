<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Smart Buy - Creative Product Review Hub</title>
  <link rel="icon" type="image/png" href="/Images/fevicon.png" rect width="2000%" height="2000%" fill="white"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Monoton&display=swap" rel="stylesheet">
  <!-- Supabase JS Client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <style>
    :root {
      --bg: #101a29;
      --card: #0b1220;
      --accent: #7c3aed;
      --accent-2: #06b6d4;
      --muted: #9aa6b2;
    }
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      font-family: Inter, system-ui, Arial;
      background: var(--bg);
      color: #e6eef6;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      padding: 24px;
      background: var(--card);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
   .brand-top {
      display: flex;
      align-items: center;
      gap: 10px;  /* space between logo and text */
    }

    .logo {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      background: linear-gradient(135deg, #ff6a00, #ff4081, #8c52ff);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      font-weight: bold;
      color: white;
      font-family: Arial, sans-serif;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
      cursor: pointer;
    }

    .brand-text {
      font-family: 'Monoton', cursive;
      font-size: 38px;
      color: #8c52ff;
      margin: 0;
      letter-spacing: 1px;
      font-weight: 500;
      word-spacing: 1px;
      cursor: pointer;
    }
   p.lead {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      cursor: pointer;
    }

      
    nav a {
      color: var(--muted);
      margin-left: 24px;
      text-decoration: none;
      font-weight: 600;
      font-size: 15px;
      transition: color 0.2s;
      cursor: pointer;
      font-family: 'Poppins', Arial, Helvetica, sans-serif;
      box-sizing: border-box;
    }
       .btn {
      padding: 0.625rem 1.5rem;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 0.938rem;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
      text-decoration: none;
      display: inline-block;
    } 
      .btn-outline {
      background: transparent;
      border: 1px solid var(--border);
      color: #fff;
    }

    .btn-outline:hover {
      background: rgb(73, 155, 226);
       color: whitesmoke;
      text-decoration:underline;
      text-decoration-thickness: 2px;
    }

    .btn-gradient {
      background: linear-gradient(135deg, #8b5cf6, #06b6d4);
      color: #fff;
      border: none;
    }

    .btn-gradient:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 24px rgba(139, 92, 246, 0.4);
    }  
    .hero {
      text-align: center;
      padding: 30px 40px 10px 40px;
      background: linear-gradient(120deg, var(--accent), var(--accent-2));
      color: #fff;
    }
    
.hero-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  max-width: 1200px;
  margin: 0 auto;
  gap: 32px;
  padding: 0 5px;
}

.hero-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 48px;
  max-width: 1100px;
  margin: 0 auto;
}
.hero-text {
  flex: 1 1 0;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 18px;
}
.hero-text h1 {
  font-size: 3rem;
  margin: 0 0 18px 0;
  font-family: 'Poppins', Arial, Helvetica, sans-serif;
  font-weight: bold;
  align-items: flex-start;
  margin-left: -60px; 
}
.hero-text p {
  font-size: 1.5rem;
  margin-bottom: 32px;

}
 .hero-text .italic-text {
      font-style: italic;
      color: rgba(247, 239, 239, 0.984);
      margin-bottom: 2rem;
    }
.hero-image {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  animation:myDiv 5s ease-in-out infinite;
  @keyframes myDiv {
    50% {box-shadow: 10px 20px 30px ;}
}
  }

.hero-image img {
  max-width: 360px;
  width: 100%;
  border-radius: 16px;
  box-shadow: 0 12px 32px rgba(0,0,0,0.18);
}
    .hero h1 {
      font-size: 48px;
      margin-bottom: 5px;
    }
    .hero p {
      font-size: 22px;
      color: #e6eef6;
      margin-bottom: -10px;
    }
   .btn-primary {
  background: linear-gradient(90deg, #9158f4, #06b6d4);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 12px 32px;
  font-size: 1.15rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
  box-shadow: 0px 2px 14px rgba(124, 58, 237, 0.12);
}
.btn-primary:hover {
  background: linear-gradient(90deg, #7c3aed, #0ea5e9);
  transform: scale(1.05);
}
.h2 {
  font-size: 28px;
  margin-bottom: 16px;
  font-weight: 600;
  color: whitesmoke;
  letter-spacing: 1px;
  word-spacing: 2px;
  cursor: pointer;
  display: inline-block;
  padding: 8px 16px;
  border-radius: 8px;
}
.h2:hover {
  color: whitesmoke;
  border-color: var(--accent);
  transform: scale(1.1); /* zoom effect */
   opacity: 0;
  transform: scale(0.5);
  animation: pushIn 0.8s forwards;
}
@keyframes pushIn {
  to {
    opacity: 1;
    transform: scale(1);
  }
}
.process {
    background: linear-gradient(250deg, var(--accent), var(--accent-2));
    color:rgb(255, 255, 255);
    padding: 4rem 10rem;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 2rem;
   *{ margin: 0;
    margin-bottom: 1px;
    padding: 0;
    box-sizing:border-box;
    font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
}}
.step {
    flex: 5 5 5px;
    text-align:center;
    padding: 1rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.1); 
    box-shadow: 0 8px 32px rgba(7, 12, 20, 0.15);
    transition: transform 0.15s;
    border: 1px solid rgba(255,255,255,0.04);
    min-width: 220px;
    max-width: 300px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    display: grid;

}
.step:hover {
    transform: translateY(-6px) scale(1.03);
    border-color: var(--accent);
}
.step h3 {
    margin-bottom: 0.5rem;
    font-size: 1.5rem;
    color: #fff;
}
.step p {
    font-size: 1.1rem;
    color: #e6eef6;
}
@media (max-width: 768px) {
  .process {
    flex-direction: column;
    padding: 2rem;
  }
  .step {
    flex: 1 1 100%;
  }
}
.mobilesImage {
    display: flex
;
    margin: 0;
    padding: 0;
    background: transparent;
    background-color: whitesmoke;
}
.zoom-animation {
  animation: zoomInOut 3.5s ease-in-out infinite;
}

@keyframes zoomInOut {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(0.9); } /* Adjust value for intensity */
}

.filter-btn {
  background: #192a56; /* original color */
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 10px 24px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
  box-shadow: 0px 2px 14px rgba(25, 42, 86, 0.12);
}
    .filter-btn:hover {
  background: #273c75;   /* lighter shade */
  transform: scale(1.05); /* slight zoom */
}
 .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
      background:#06b6d4
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 2rem;
      margin-bottom: 1.5rem;
      margin-top: 0.5rem;
      justify-items: center;
    }

    .card {
      background: #74b2ec;
      color: #000;
      border-radius: 14px;
      padding: 2rem;
      margin-top: -5px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 25px 48px rgba(71, 8, 218, 0.3);
      border-color: var(--accent);
    }

    .card-image {
      height: 200px;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f3f4f6;
      border-radius: 10px;
      margin-bottom: 1rem;
      overflow: hidden;
    }

    .card-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 10px;
    }

    .card h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 1.75rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 0.75rem;
    }

    .card p {
      text-align: center;
      color: #000000;
      margin-bottom: 1rem;
    }
  
      /* Why Smart Buy */
          .card why-buy{
      background: #fff;
      color: #000;
      border-radius: 14px;
      padding: 1.5rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .why-cards .card {
      text-align: center;
    }

    .card-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }  
    .rating {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }

    .stars {
      display: flex;
      gap: 0.125rem;
    }

    .star {
      color: #fbbf24;
      font-size: 1rem;
    }

    .star.empty {
      color: #d1d5db;
    }

    .reviews {
      text-align: center;
      font-size: 0.875rem;
      color: #9ca3af;
      margin-bottom: 1rem;
    }

    .btn-card {
      width: 100%;
      padding: 0.625rem;
      background: transparent;
      border: 1px solid #d1d5db;
      color: #000;
      border-radius: 6px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-card:hover {
      background: #f3f4f6;
      border-color: var(--primary);
    }

    .text-center {
      text-align: center;
    }

    /* Reviews Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      overflow: auto;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: linear-gradient(135deg, #0b1220, #1a2332);
      margin: 2rem auto;
      padding: 0;
      border-radius: 16px;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-header {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      padding: 1.5rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-header h2 {
      margin: 0;
      color: white;
      font-size: 1.5rem;
      font-weight: 600;
    }

    .close-modal {
      color: white;
      font-size: 2rem;
      font-weight: bold;
      cursor: pointer;
      background: none;
      border: none;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s;
    }

    .close-modal:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }

    .modal-body {
      padding: 2rem;
      max-height: calc(90vh - 180px);
      overflow-y: auto;
    }

    .review-item {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s;
    }

    .review-item:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--accent-2);
      transform: translateY(-2px);
    }

    .review-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .reviewer-info {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .reviewer-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 1rem;
      text-transform: uppercase;
    }

    .reviewer-details h4 {
      margin: 0;
      color: #e6eef6;
      font-size: 1rem;
      font-weight: 600;
    }

    .reviewer-details p {
      margin: 0;
      color: var(--muted);
      font-size: 0.875rem;
    }

    .review-rating {
      display: flex;
      gap: 0.25rem;
    }

    .review-rating .star {
      color: #fbbf24;
      font-size: 1.125rem;
    }

    .review-rating .star.empty {
      color: #4b5563;
    }

    .review-text {
      color: #e6eef6;
      line-height: 1.6;
      margin-top: 1rem;
    }

    .no-reviews {
      text-align: center;
      padding: 3rem 1rem;
      color: var(--muted);
    }

    .no-reviews svg {
      width: 64px;
      height: 64px;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .review-summary {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .summary-rating {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .summary-rating .big-number {
      font-size: 3rem;
      font-weight: bold;
      color: #fbbf24;
      line-height: 1;
    }

    .summary-rating .rating-stars {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .summary-rating .stars {
      display: flex;
      gap: 0.125rem;
    }

    .summary-rating .total-reviews {
      color: var(--muted);
      font-size: 0.875rem;
    }

    /* Image Showcase */
    .showcase {
      background: #fff;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .showcase img {
      max-width: 60%;
      height: auto;
      border-radius: 16px;
      animation: zoomInOut 8.5s ease-in-out infinite;
    }
 
    footer {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin-top: auto;
      text-align: center;
      padding: 14px 0 14px 0;
      color: var(--muted);
      font-size: 13px;
      background: var(--card);
      border-top: 1px solid rgba(255,255,255,0.05);
    }
    footer a {
      color: var(--muted);
      text-decoration: none;
      margin: 0 8px;
      transition: color 0.2s;
    }
    footer a:hover {
      color: whitesmoke;
      text-decoration: underline;
      text-decoration-thickness: 1px;
    }
   
.page-title {
  font-family: 'Orbitron', sans-serif;
  font-size: 25px;
  text-align: center;
  letter-spacing: 2px;
  word-spacing: 3px;
  text-transform: uppercase;
  background: linear-gradient(90deg, #7c3aed, #06b6d4);
  background-clip: text;           /* ✅ Add this line */
  -webkit-background-clip: text;   /* for Chrome/Safari */
  -webkit-text-fill-color: transparent;
  color: transparent;              /* for Firefox compatibility */
  margin: 50px 0 40px;
  margin-bottom: -30px;
  position: relative;
  text-shadow: 0 0 12px rgba(124, 58, 237, 0.5);
}


.page-title::after {
  content: "";
  position: absolute;
  bottom: -15px;
  left: 50%;
  transform: translateX(-50%);
  width: 120px;
  height: 3px;
  background: linear-gradient(90deg, #7c3aed, #06b6d4);
  border-radius: 4px;
}
    /* Push-in animation */
.push-in {
  opacity: 0;
  transform: translateY(50px);
  transition: all 0.7s ease-out;
}

.push-in.visible {
  opacity: 1;
  transform: translateY(0);
}
 /* Responsive: Stack on mobile */
@media (max-width: 900px) {
  .hero-content {
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 0 12px;
  }
  .hero-image {
    justify-content: center;
    margin-top: 36px;
  }
  .hero-text {
    align-items: center;
  }
}

/* Dropdown wrapper */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown content */
.dropdown-content {
  display: none;
  position: absolute;
  top: 100%;
  left: -200px;
  background: #0b1220;
  color: white;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  padding: 20px;
  min-width: 600px;
  z-index: 999;
  border-radius: 12px;
  font-size: 14px;
  text-align: left;
  border: 1px solid rgba(255,255,255,0.1);
  display: none; /* Hidden by default */
  flex-direction: column;
}

/* Visible when open */
.dropdown.open .dropdown-content {
  display: block;
}

/* Mega menu grid layout */
.mega-menu {
  display: flex;
  justify-content: space-around;
  gap: 20px;
}

.mega-column h4 {
  color: #358decf8;
  font-size: 18px;
  margin-bottom: 10px;
}

.mega-column a {
  display: block;
  color: #e6eef6;
  text-decoration: none;
  margin: 6px 0;
  font-size: 15px;
}

.mega-column a:hover {
  color: #06b6d4;
  text-decoration: underline;
}
/* Profile Dropdown */
.profile-dropdown {
  position: relative;
  display: inline-block;
  margin-left: 16px;
  cursor: pointer;
}
.profile-dropdown-content {
  display: none;
  position: absolute;
  right: 0;
  background: #1b243a;
  color: white;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  padding: 12px 16px;
  min-width: 200px;
  z-index: 999;
  border-radius: 12px;
  font-size: 14px;
  text-align: left;
}
.profile-dropdown-content a, .profile-dropdown-content button {
  display: block;
  color: #e6eef6;
  text-decoration: none;
  margin: 8px 0;
  background: none;
  border: none;
  width: 100%;
  text-align: left;
  cursor: pointer;
  font-size: 14px;
  padding: 0;
}
.profile-dropdown-content a:hover, .profile-dropdown-content button:hover {
  color: #06b6d4;
  text-decoration: underline;
}
.user-profile {
  display: flex;
  align-items: center;
  gap: 8px;
}
.user-avatar {
  width: 32px;
  height: 32px;
  background: #7c3aed;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 14px;
  text-transform: uppercase;
}
.user-info h4, .user-info p {
  margin: 0;
  line-height: 1.2;
}
.user-info h4 {
  font-size: 14px;
  font-weight: 600;
}
.user-info p {
  font-size: 12px;
  color: #9aa6b2;
  font-weight: 400;
}
.divider {
  height: 1px;
  background: rgba(255,255,255,0.1);
  margin: 8px 0;
}
/* Show dropdown on click */
#productsMenu {
  display: none;
  flex-direction: row;
  gap: 24px;
  padding: 20px;
  background: #0b1220;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  position: absolute;
  top: 100%;
  left: -200px;
  z-index: 999;
  min-width: 600px;
}
#productsBtn:hover + #productsMenu,
#productsMenu:hover {
  display: flex; 
}
@media (max-width: 768px) {
  #productsMenu {
    left: -150px; /* Adjust as needed for mobile */
    min-width: 300px;
  }
  .mega-menu {
    flex-direction: column;
    gap: 12px;
  }
  .mega-column h4 {
    font-size: 16px;
  }
  .mega-column a {
    font-size: 14px;
  }
}  
  
  </style>
</head>

<body>
  <header>
    <div class="brand">
      <div class="logo"> <img src="/Images/generated-image.png" style="background-color: gray; width:125%; height:125%; object-fit:contain; border-radius:20px;">
      </div>
  
    <div>
          <h1 class="brand-text">Smart Buy</h1>
    <p class="lead">Your feedback shapes better choices — curated for shoppers</p>
    </div>  
    </div>
    <nav>
    <button onclick="window.location.href='#Home'" class="btn btn-outline">Home</button>
    <div class="dropdown">
    <button onclick="window.location.href='#Products'" class=" btn btn-outline" id="productsBtn">Products</button>
     <div class="dropdown-content" id="productsMenu">
     <div class="mega-menu">
        <div class="mega-column">
          <h4>Electronics</h4>
          <a onclick="window.location.href='/HomePage/smartphones.html'">Smartphones</a>
          <a href="#">Laptops</a>
          <a href="#">Headphones</a>
        </div>
        <div class="mega-column">
          <h4>Home & Living</h4>
          <a onclick="window.location.href='/HomePage/appliances.html'">Appliances</a>
          <a href="#">Kitchen</a>
        </div>
        <div class="mega-column">
          <h4>Fashion & Lifestyle</h4>
          <a href="#">Men’s Fashion</a>
          <a href="#">Women’s Fashion</a>
          <a onclick="window.location.href='/HomePage/shoes.html'">Shoes</a>
          <a href="#">Fitness</a>
        </div>
        <div class="mega-column">
          <h4>Amazon</h4>
          <a onclick="window.location.href='/Amazon/amazonproducts.html'">Top Products</a>
        </div>
      </div>
    </div>
    </div>
    <button onclick="window.location.href='#About'" class="btn btn-outline">About</button>
    <button onclick="window.location.href='#Contact'" class="btn btn-outline">Contact</button>&nbsp;
  <button id="signInBtn" onclick="window.location.href='/auth/signup.html'" class="btn btn-gradient">Sign In</button>
    </nav>
        
        <!-- User Profile Section -->
        <div data-auth="logout" style="display: none; gap: 12px; align-items: center;">
          <button class="review-btn" id="openReview" style="padding: 8px 16px; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent-2)); border: none; color: white; cursor: pointer; font-weight: 600;">Write Review</button>
          
          <div class="profile-dropdown">
            <div class="user-profile" id="userProfileBtn" style="cursor: pointer;">
              <div class="user-avatar" id="userAvatar">U</div>
              <div class="user-info">
                <h4 id="userName">User</h4>
                <p id="userEmail">user@example.com</p>
              </div>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"/>
              </svg>
            </div>
            
            <div class="profile-dropdown-content">
              <a href="#" id="profileSettings">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; margin-right: 8px;">
                  <circle cx="12" cy="12" r="3"/>
                  <path d="M12 1v6m0 10v6m11-7h-6m-10 0H1m15.5-6.5l-4.24 4.24M7.76 7.76L3.52 3.52m12.73 12.73l4.24 4.24M7.76 16.24l-4.24 4.24"/>
                </svg>
                Profile Settings
              </a>
              <a href="#" id="myReviews">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; margin-right: 8px;">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26"/>
                </svg>
                My Reviews
              </a>
              <div class="divider"></div>
              <button id="logoutBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; margin-right: 8px;">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                  <polyline points="16,17 21,12 16,7"/>
                  <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                Logout
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

  <div class="hero">
  <div class="hero-content">
    <div class="hero-text">
  
    <h1 style="font-family: 'poppins'; letter-spacing:1px; text-align:center;" > “ Where reviews meet smart choices. ”</h1>
    <p >Discover the best products, reviews, and deals  — all in one spot.</p>
    <p class="italic-text">“Find it. Rate it. Own it - Real reviews.Real trust.”</p>
  </div>
  <div class="hero-image">
      <img class="myDiv" src="/Images/user-reviews-laptop.avif" alt="SmartBuy Example" style="max-width:390px; width:100%; border-radius:18px;" />
    </div>
  </div>
</div>

  <section>
  <div style="text-align: center; font:bold; font-family:A; color:rgba(118, 117, 117, 0.847); font-size: 22px; margin-top: -10px;">
    <div class="h2">
      <div class="page-title push-in">
      <h1>Featured Products</h1>
    </div>
    </div>
</div>
     <div class="grid">
        <div class="card">
          <div class="card-image">
            <img src="/Images/wirelessheadphones.webp" alt="boAt Wireless Headphones" />
          </div>
          <h3>boAt Wireless Headphones</h3>
          <div class="rating">
            <div class="stars">
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
            </div>
            <span>4.5</span>
          </div>
          <p>Top-rated for sound quality and comfort.</p>
          <p class="reviews">1,247 reviews</p>
          <button class="btn-card" data-product-id="boat-wireless-headphones" data-product-name="boAt Wireless Headphones">Read Reviews</button>
        </div>

        <div class="card">
          <div class="card-image">
            <img src="/Images/acernitro5.webp" alt="Acer Nitro 5 Gaming Laptop" />
          </div>
          <h3>Acer Nitro 5 Gaming Laptop</h3>
          <div class="rating">
            <div class="stars">
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
            </div>
            <span>4.7</span>
          </div>
          <p>Top choice for gamers and professionals alike.</p>
          <p class="reviews">892 reviews</p>
          <button class="btn-card" data-product-id="acer-nitro-5-gaming-laptop" data-product-name="Acer Nitro 5 Gaming Laptop">Read Reviews</button>
        </div>

        <div class="card">
          <div class="card-image">
            <img src="/Images/fitnesstracker.jpg" alt="Lunar Vista Fitness Tracker" />
          </div>
          <h3>Lunar Vista Fitness Tracker</h3>
          <div class="rating">
            <div class="stars">
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star">★</span>
              <span class="star empty">★</span>
            </div>
            <span>4.3</span>
          </div>
          <p>Highly rated for accuracy and features.</p>
          <p class="reviews">654 reviews</p>
          <button class="btn-card" data-product-id="lunar-vista-fitness-tracker" data-product-name="Lunar Vista Fitness Tracker">Read Reviews</button>
        </div>
      </div>

      <div class="text-center">
  <a href="/HomePage/allproducts.html"><button class="btn btn-gradient btn-hero">See All Products</button></a>
      </div>
    </div>
  </section>
  <br><br>

 <!-- Process Section -->
 <section class="process">
  <div class="process">
    <div class="step">
      <h3>Step 1</h3>
      <p>Browse categories and find your product.</p>
    </div>
    <div class="step">
      <h3>Step 2</h3>
      <p>Check reviews, ratings, and comparisons.</p>
    </div>
    <div class="step">
      <h3>Step 3</h3>
      <p>Buy with confidence using trusted sources.</p>
    </div>
  </section>
</div>

<section>
<div style="text-align: center; font:bold; font-family:A; color:whitesmoke; font-size: 22px; margin-top: 32px;">
  <h2>Why Smart Buy ?</h2>
  <div class=".card why-buy">
    <div class="grid why-cards">
    <div class="card">
      <h3>Top Products</h3>
      <p>Curated selection of highly-rated products.</p>
    </div>
    <div class="card">
      <h3>Write a Review</h3>
      <p>Help others by sharing your experience.</p>
    </div>
    <div class="card">
      <h3>Special Offers</h3>
      <p>Don’t miss the best deals and discounts.</p>
    </div>
    </div>
  </div>
  </div>
  </section>
  <!-- Reviews Modal -->
  <div id="reviewsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalProductName">Product Reviews</h2>
        <button class="close-modal" onclick="closeReviewsModal()">&times;</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- Reviews will be loaded here -->
        <div style="text-align: center; padding: 2rem;">
          <div class="loading" style="display: inline-block; width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: var(--accent-2); animation: spin 1s linear infinite;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Write Review Modal -->
  <div id="writeReviewModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Write a Review</h2>
        <button class="close-modal" onclick="closeWriteReviewModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="writeReviewForm" style="display:flex; flex-direction: column; gap: 14px;">
          <div>
            <label for="reviewProduct" style="display:block; margin-bottom:6px; color:#e6eef6;">Product</label>
            <select id="reviewProduct" required style="width:100%; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.15); background:#0f172a; color:#e6eef6;">
              <!-- Options injected by JS -->
            </select>
          </div>
          <div>
            <label for="reviewRating" style="display:block; margin-bottom:6px; color:#e6eef6;">Rating</label>
            <select id="reviewRating" required style="width:100%; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.15); background:#0f172a; color:#e6eef6;">
              <option value="">Select rating</option>
              <option value="5">★★★★★ (5)</option>
              <option value="4">★★★★☆ (4)</option>
              <option value="3">★★★☆☆ (3)</option>
              <option value="2">★★☆☆☆ (2)</option>
              <option value="1">★☆☆☆☆ (1)</option>
            </select>
          </div>
          <div>
            <label for="reviewText" style="display:block; margin-bottom:6px; color:#e6eef6;">Your Review</label>
            <textarea id="reviewText" rows="5" required placeholder="Share your experience..." style="width:100%; padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.15); background:#0f172a; color:#e6eef6; resize:vertical;"></textarea>
          </div>
          <div id="writeReviewMessage" style="min-height:18px; font-size:0.9rem;"></div>
          <div style="display:flex; gap:10px; justify-content:flex-end;">
            <button type="button" class="btn btn-outline" onclick="closeWriteReviewModal()">Cancel</button>
            <button type="submit" id="submitReviewBtn" class="btn btn-gradient">Submit Review</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <footer>
      <p>
      <a href="#">About</a> | 
      <a href="#">Privacy</a> | 
      <a href="#">Terms</a> | 
      <a href="#">Contact</a>
    </p>
    Made with — Smart♥Buy. Try writing a review to see it live!<br><br>
    &copy; 2025 SmartBuy. All rights reserved.
  </footer>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // Animate "push-in" title
  const target = document.querySelector(".push-in");
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add("visible");
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.3 });
  if (target) observer.observe(target);

  // ====== Mega Menu (Products Dropdown) ======
  const productsBtn = document.getElementById("productsBtn");
  const productsMenu = document.getElementById("productsMenu");
  let hideTimeout;

  // Show dropdown on hover
  productsBtn.addEventListener("mouseenter", () => {
    clearTimeout(hideTimeout);
    productsMenu.style.display = "flex";
  });

  productsBtn.addEventListener("mouseleave", () => {
    hideTimeout = setTimeout(() => {
      productsMenu.style.display = "none";
    }, 200);
  });

  productsMenu.addEventListener("mouseenter", () => {
    clearTimeout(hideTimeout);
    productsMenu.style.display = "flex";
  });

  productsMenu.addEventListener("mouseleave", () => {
    hideTimeout = setTimeout(() => {
      productsMenu.style.display = "none";
    }, 200);
  });

  // ====== Profile Dropdown ======
  const userProfileBtn = document.getElementById("userProfileBtn");
  const profileDropdown = document.querySelector(".profile-dropdown-content");

  userProfileBtn?.addEventListener("click", () => {
    profileDropdown.style.display =
      profileDropdown.style.display === "block" ? "none" : "block";
  });

  // Hide profile dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (
      !e.target.closest(".profile-dropdown") &&
      !e.target.closest("#userProfileBtn")
    ) {
      profileDropdown.style.display = "none";
    }
  });
});
</script>

<script type="module">
  // Initialize Supabase
  import { SUPABASE_CONFIG } from '../config.js';
  
  const supabaseClient = window.supabase.createClient(
    SUPABASE_CONFIG.url,
    SUPABASE_CONFIG.anonKey
  );

  // ===== Auth-aware Navbar =====
  function getDisplayInfo(user) {
    const email = user?.email || '';
    const fullName = user?.user_metadata?.full_name || user?.user_metadata?.fullName || '';
    const name = fullName || (email ? email.split('@')[0] : 'User');
    const initial = name?.charAt(0)?.toUpperCase() || 'U';
    return { name, email, initial };
  }

  async function syncAuthUI(session) {
    try {
      // Resolve session if not provided
      if (!session) {
        const { data } = await supabaseClient.auth.getSession();
        session = data?.session || null;
      }

      const signInBtn = document.getElementById('signInBtn');
      const authContainer = document.querySelector('[data-auth="logout"]');
      const userNameEl = document.getElementById('userName');
      const userEmailEl = document.getElementById('userEmail');
      const userAvatarEl = document.getElementById('userAvatar');
      const logoutBtn = document.getElementById('logoutBtn');

      if (session && session.user) {
        // Show profile, hide sign in
        if (authContainer) authContainer.style.display = 'flex';
        if (signInBtn) signInBtn.style.display = 'none';

        const { name, email, initial } = getDisplayInfo(session.user);
        if (userNameEl) userNameEl.textContent = name;
        if (userEmailEl) userEmailEl.textContent = email;
        if (userAvatarEl) userAvatarEl.textContent = initial;

        // Wire logout (once)
        if (logoutBtn && !logoutBtn.dataset.bound) {
          logoutBtn.addEventListener('click', async () => {
            await supabaseClient.auth.signOut();
            await syncAuthUI(null);
          }, { once: false });
          logoutBtn.dataset.bound = 'true';
        }
      } else {
        // Not logged in: hide profile, show sign in
        if (authContainer) authContainer.style.display = 'none';
        if (signInBtn) signInBtn.style.display = '';
      }
    } catch (e) {
      console.error('Auth UI sync error:', e);
    }
  }

  // Initial sync and subscribe to auth changes
  (async () => {
    await syncAuthUI(null);
    supabaseClient.auth.onAuthStateChange((_event, session) => {
      syncAuthUI(session);
    });
  })();

  // Product data with IDs matching your database
  const products = [
    {
      id: 'boat-wireless-headphones',
      name: 'boAt Wireless Headphones',
      selector: '.card:nth-child(1)'
    },
    {
      id: 'acer-nitro-5-gaming-laptop',
      name: 'Acer Nitro 5 Gaming Laptop',
      selector: '.card:nth-child(2)'
    },
    {
      id: 'lunar-vista-fitness-tracker',
      name: 'Lunar Vista Fitness Tracker',
      selector: '.card:nth-child(3)'
    }
  ];

  // Dummy reviews fallback (used if Supabase has no data or is unavailable)
  const DUMMY_REVIEWS = {
    'boat-wireless-headphones': [
      {
        user_name: 'Aarav',
        rating: 5,
        review_text: 'Amazing sound and battery life. Super comfy for long sessions!',
        created_at: '2025-01-10T10:00:00Z'
      },
      {
        user_name: 'Meera',
        rating: 4,
        review_text: 'Great overall. Bluetooth drops once in a while but still worth it.',
        created_at: '2025-01-14T12:30:00Z'
      },
      {
        user_name: 'Kabir',
        rating: 5,
        review_text: 'Best in this price segment. Clear highs and punchy bass.',
        created_at: '2025-01-18T09:20:00Z'
      }
    ],
    'acer-nitro-5-gaming-laptop': [
      {
        user_name: 'Priya',
        rating: 5,
        review_text: 'Plays AAA titles smoothly. Cooling is solid and the keyboard feels great.',
        created_at: '2024-12-12T16:20:00Z'
      },
      {
        user_name: 'Rohan',
        rating: 4,
        review_text: 'Powerful and reliable. A bit heavy to carry, but performance is top-notch.',
        created_at: '2024-12-28T11:00:00Z'
      },
      {
        user_name: 'Sara',
        rating: 5,
        review_text: 'Exceeded expectations for both gaming and work tasks.',
        created_at: '2025-01-08T13:30:00Z'
      }
    ],
    'lunar-vista-fitness-tracker': [
      {
        user_name: 'Vikram',
        rating: 4,
        review_text: 'Accurate tracking and comfortable to wear. Battery lasts almost a week.',
        created_at: '2024-12-18T08:45:00Z'
      },
      {
        user_name: 'Nia',
        rating: 4,
        review_text: 'Syncs well with phone. Would love a few more sport modes.',
        created_at: '2025-01-02T15:20:00Z'
      },
      {
        user_name: 'Dev',
        rating: 5,
        review_text: 'Waterproofing is excellent and notifications are timely.',
        created_at: '2025-01-12T10:00:00Z'
      }
    ]
  };

  // Fetch reviews for a specific product
  async function fetchProductReviews(productId) {
    try {
      const { data, error } = await supabaseClient
        .from('reviews')
        .select('*')
        .eq('product_id', productId)
        .order('created_at', { ascending: false });

      if (error) {
        console.error('Error fetching reviews:', error);
        // Fall back to dummy if available
        const dummy = DUMMY_REVIEWS[productId] || [];
        if (dummy.length) {
          const avgRating = (dummy.reduce((s, r) => s + Number(r.rating || 0), 0) / dummy.length).toFixed(1);
          return { reviews: dummy, avgRating: parseFloat(avgRating), totalReviews: dummy.length };
        }
        return { reviews: [], avgRating: 0, totalReviews: 0 };
      }

      // Calculate average rating
      let useData = data;
      if (!useData || useData.length === 0) {
        // No data in DB, try dummy
        const dummy = DUMMY_REVIEWS[productId] || [];
        useData = dummy;
      }
      const avgRating = useData.length > 0
        ? (useData.reduce((sum, review) => sum + Number(review.rating || 0), 0) / useData.length).toFixed(1)
        : 0;

      return {
        reviews: useData,
        avgRating: parseFloat(avgRating),
        totalReviews: useData.length
      };
    } catch (error) {
      console.error('Error:', error);
      const dummy = DUMMY_REVIEWS[productId] || [];
      if (dummy.length) {
        const avgRating = (dummy.reduce((s, r) => s + Number(r.rating || 0), 0) / dummy.length).toFixed(1);
        return { reviews: dummy, avgRating: parseFloat(avgRating), totalReviews: dummy.length };
      }
      return { reviews: [], avgRating: 0, totalReviews: 0 };
    }
  }

  // Update product card with real review data
  function updateProductCard(selector, reviewData) {
    const card = document.querySelector(selector);
    if (!card) return;

    const { avgRating, totalReviews } = reviewData;

    // Update rating display
    const ratingSpan = card.querySelector('.rating span');
    if (ratingSpan) {
      ratingSpan.textContent = avgRating > 0 ? avgRating : '0.0';
    }

    // Update stars
    const starsContainer = card.querySelector('.stars');
    if (starsContainer) {
      const fullStars = Math.floor(avgRating);
      const hasHalfStar = avgRating % 1 >= 0.5;
      
      starsContainer.innerHTML = '';
      
      // Add full stars
      for (let i = 0; i < fullStars; i++) {
        starsContainer.innerHTML += '<span class="star">★</span>';
      }
      
      // Add half star if needed
      if (hasHalfStar && fullStars < 5) {
        starsContainer.innerHTML += '<span class="star">★</span>';
      }
      
      // Add empty stars
      const emptyStars = 5 - Math.ceil(avgRating);
      for (let i = 0; i < emptyStars; i++) {
        starsContainer.innerHTML += '<span class="star empty">★</span>';
      }
    }

    // Update review count
    const reviewsText = card.querySelector('.reviews');
    if (reviewsText) {
      reviewsText.textContent = `${totalReviews} ${totalReviews === 1 ? 'review' : 'reviews'}`;
    }
  }

  // Fetch and update all product reviews
  async function loadAllReviews() {
    for (const product of products) {
      const reviewData = await fetchProductReviews(product.id);
      updateProductCard(product.selector, reviewData);
    }
  }

  // Load reviews when page loads
  document.addEventListener('DOMContentLoaded', () => {
    loadAllReviews();
  });

  // Modal functions
  window.openReviewsModal = async function(productId, productName) {
    const modal = document.getElementById('reviewsModal');
    const modalBody = document.getElementById('modalBody');
    const modalProductName = document.getElementById('modalProductName');
    
    // Set product name
    modalProductName.textContent = `${productName} - Reviews`;
    
    // Show modal with loading state
    modal.classList.add('active');
    modalBody.innerHTML = '<div style="text-align: center; padding: 2rem;"><div class="loading" style="display: inline-block; width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: var(--accent-2); animation: spin 1s linear infinite;"></div></div>';
    
    // Fetch reviews
    const reviewData = await fetchProductReviews(productId);
    
    // Build reviews HTML
    let html = '';
    
    if (reviewData.totalReviews > 0) {
      // Summary section
      html += `
        <div class="review-summary">
          <div class="summary-rating">
            <div class="big-number">${reviewData.avgRating}</div>
            <div class="rating-stars">
              <div class="stars">
                ${generateStarsHTML(reviewData.avgRating)}
              </div>
              <div class="total-reviews">${reviewData.totalReviews} ${reviewData.totalReviews === 1 ? 'review' : 'reviews'}</div>
            </div>
          </div>
        </div>
      `;
      
      // Individual reviews
      reviewData.reviews.forEach(review => {
        const reviewDate = new Date(review.created_at).toLocaleDateString('en-US', { 
          year: 'numeric', 
          month: 'short', 
          day: 'numeric' 
        });
        
        const userInitial = review.user_name ? review.user_name.charAt(0).toUpperCase() : 'U';
        
        html += `
          <div class="review-item">
            <div class="review-header">
              <div class="reviewer-info">
                <div class="reviewer-avatar">${userInitial}</div>
                <div class="reviewer-details">
                  <h4>${review.user_name || 'Anonymous User'}</h4>
                  <p>${reviewDate}</p>
                </div>
              </div>
              <div class="review-rating">
                ${generateStarsHTML(review.rating)}
              </div>
            </div>
            <div class="review-text">${review.review_text || 'No review text provided.'}</div>
          </div>
        `;
      });
    } else {
      html = `
        <div class="no-reviews">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
          </svg>
          <h3>No Reviews Yet</h3>
          <p>Be the first to review this product!</p>
        </div>
      `;
    }
    
    modalBody.innerHTML = html;
  }

  window.closeReviewsModal = function() {
    const modal = document.getElementById('reviewsModal');
    modal.classList.remove('active');
  }

  // Generate stars HTML helper
  function generateStarsHTML(rating) {
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;
    const emptyStars = 5 - Math.ceil(rating);
    
    let html = '';
    
    for (let i = 0; i < fullStars; i++) {
      html += '<span class="star">★</span>';
    }
    
    if (hasHalfStar && fullStars < 5) {
      html += '<span class="star">★</span>';
    }
    
    for (let i = 0; i < emptyStars; i++) {
      html += '<span class="star empty">★</span>';
    }
    
    return html;
  }

  // Add event listeners to Read Reviews buttons
  document.addEventListener('DOMContentLoaded', () => {
    const reviewButtons = document.querySelectorAll('.btn-card');
    reviewButtons.forEach(button => {
      button.addEventListener('click', () => {
        const productId = button.getAttribute('data-product-id');
        const productName = button.getAttribute('data-product-name');
        if (productId && productName) {
          openReviewsModal(productId, productName);
        }
      });
    });
    
    // Wire Write Review button
    const writeBtn = document.getElementById('openReview');
    if (writeBtn) {
      writeBtn.addEventListener('click', async () => {
        await openWriteReviewModal();
      });
    }

    // Close modal when clicking outside
    const modal = document.getElementById('reviewsModal');
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeReviewsModal();
      }
    });
    
    // Close modal on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeReviewsModal();
        closeWriteReviewModal();
      }
    });

    // Handle write review submission
    const writeForm = document.getElementById('writeReviewForm');
    if (writeForm) {
      writeForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const msg = document.getElementById('writeReviewMessage');
        const productSelect = document.getElementById('reviewProduct');
        const ratingSelect = document.getElementById('reviewRating');
        const reviewTextEl = document.getElementById('reviewText');
        const submitBtn = document.getElementById('submitReviewBtn');

        msg.textContent = '';
        submitBtn.disabled = true;
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Submitting...';

        try {
          const productId = productSelect.value;
          const rating = parseInt(ratingSelect.value, 10);
          const reviewText = reviewTextEl.value.trim();

          if (!productId || !rating || !reviewText) {
            msg.style.color = '#ff8a8a';
            msg.textContent = 'Please select a product, choose a rating, and write your review.';
            return;
          }

          const product = products.find(p => p.id === productId);
          const productName = product ? product.name : productId;

          const { data: { session } } = await supabaseClient.auth.getSession();
          if (!session) {
            msg.style.color = '#ffcc66';
            msg.textContent = 'Please sign in to write a review.';
            // Optionally redirect
            // window.location.href = '/auth/signup.html';
            return;
          }

          const { error } = await supabaseClient
            .from('reviews')
            .insert([
              {
                user_id: session.user.id,
                product_id: productId,
                product_name: productName,
                rating: rating,
                review_text: reviewText
              }
            ]);

          if (error) {
            console.error('Insert error:', error);
            msg.style.color = '#ff8a8a';
            msg.textContent = 'Could not submit review. Please try again.';
            return;
          }

          msg.style.color = '#67e8f9';
          msg.textContent = 'Review submitted! Updating...';

          // Refresh product card with latest data
          const data = await fetchProductReviews(productId);
          if (product) {
            updateProductCard(product.selector, data);
          }

          // Reset form and close after a short delay
          writeForm.reset();
          setTimeout(() => {
            closeWriteReviewModal();
            msg.textContent = '';
          }, 900);

        } catch (err) {
          console.error('Unexpected error:', err);
          msg.style.color = '#ff8a8a';
          msg.textContent = 'Unexpected error occurred.';
        } finally {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });
    }
  });
</script>

<style>
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
</style>

<script type="module">
  // Write Review modal helpers
  function openWriteReviewModalPrefillOptions(defaultProductId = '') {
    const modal = document.getElementById('writeReviewModal');
    const select = document.getElementById('reviewProduct');
    const msg = document.getElementById('writeReviewMessage');
    const ratingSelect = document.getElementById('reviewRating');
    const reviewTextEl = document.getElementById('reviewText');

    if (msg) msg.textContent = '';
    if (ratingSelect) ratingSelect.value = '';
    if (reviewTextEl) reviewTextEl.value = '';

    // Fill product options
    if (select) {
      select.innerHTML = '';
      products.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.id;
        opt.textContent = p.name;
        if (defaultProductId && p.id === defaultProductId) {
          opt.selected = true;
        }
        select.appendChild(opt);
      });
    }
    if (modal) modal.classList.add('active');
  }

  // Expose to other handlers
  window.openWriteReviewModal = async function(defaultProductId = '') {
    try {
      const { data: { session } } = await supabaseClient.auth.getSession();
      if (!session) {
        // If not logged in, direct to sign-in
        window.location.href = '/auth/signup.html';
        return;
      }
      openWriteReviewModalPrefillOptions(defaultProductId);
    } catch (e) {
      console.error('Open write modal error:', e);
      openWriteReviewModalPrefillOptions(defaultProductId);
    }
  }

  window.closeWriteReviewModal = function() {
    const modal = document.getElementById('writeReviewModal');
    if (modal) modal.classList.remove('active');
  }
</script>

</body>
</html>


<!--
  Smart Buy - Creative Product Review Hub
  A sleek, modern homepage design for a product review website.
  Features a dark theme with vibrant accent colors, a hero section,
  featured products, and a simple three-step process explanation.
  Designed for clarity, ease of use, and visual appeal.


  <section>
  <div style="background: var(--accent-2); padding: 40px 0 20px 0; margin-top: -20px;"></div>
    <div style="text-align: center; font:bold; font-family:A; color:whitesmoke; font-size: 22px; margin-top: -10px;">
      <div class="h2">
        <h2 class="push-in">Popular Categories</h2>
      </div>
    </div>
    <div class="grid" style="text-align: center; font:bold; font-family:A; color:whitesmoke; font-size: 22px; margin-top: -32px;">
      <div class="card">
        <div style="display: flex; justify-content: center; align-items: center; height: 150px; margin-bottom: 16px;">
          <img src="/Images/electronics.jpg" alt="Electronics" style="max-width: 100%; max-height: 115%; border-radius: 10px;" /> 
        </div>
        <h3>Electronics</h3>
        <p>Latest gadgets and devices.</p>
      </div>
      <div class="card">
        <div style="display: flex; justify-content: center; align-items: center; height: 150px; margin-bottom: 16px;">
          <img src="/Images/homeappliances.jpg" alt="Home Appliances" style="max-width: 100%; max-height: 115%; border-radius: 10px;" /> 
        </div>
        <h3>Home Appliances</h3>
        <p>Essentials for your home.</p>
      </div>
      <div class="card">
        <div style="display: flex; justify-content: center; align-items: center; height: 150px; margin-bottom: 16px;">
          <img src="/Images/fashion.jpg" alt="Fashion" style="max-width: 100%; max-height: 115%; border-radius: 10px;" /> 
        </div>
        <h3>Fashion</h3>
        <p>Trendy clothing and accessories.</p>
      </div>
    </div>
    <div style="margin-top: 24px; text-align: center;">
      <button class="filter-btn" style="background: linear-gradient(250deg, var(--accent), var(--accent-2));">See All Categories</button><br><br>
  </div>
  </section>-->
