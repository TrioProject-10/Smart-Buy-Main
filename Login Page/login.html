<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SmartBuy Login</title>
<style>
  body { font-family: Arial, sans-serif; background: #0f1724; color: white; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
  #authBox { background: rgba(255,255,255,0.05); padding: 24px; border-radius: 12px; width: 320px; text-align:center; }
  input { width: 100%; margin: 12px 0; padding: 10px; border: none; border-radius: 6px; }
  button { width: 100%; padding: 10px; margin-top: 12px; background: linear-gradient(90deg,#7c3aed,#06b6d4); border:none; border-radius:6px; color:white; font-weight: bold; cursor: pointer; }
  button:hover { opacity: 0.9; }
  #message { margin-top: 12px; color: #f88; }
  .logo { font-family: 'Monoton', cursive; font-size: 36px; margin-bottom: 12px; color: #7c3aed; }
</style>
</head>
<body>

<div id="authBox">
  <div class="logo">SmartBuy</div>
  <input id="username" type="text" placeholder="Username" />
  <input id="password" type="password" placeholder="Password" />
  <button id="loginBtn">Log In</button>
  <button id="registerBtn">Sign Up</button>
  <div id="message"></div>
</div>

<script>
  const loginBtn = document.getElementById('loginBtn');
  const registerBtn = document.getElementById('registerBtn');
  const message = document.getElementById('message');

  function postData(url, data) {
    return fetch(url, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(data)
    }).then(res => res.json());
  }

  loginBtn.onclick = () => {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    if (!username || !password) {
      message.textContent = 'Please fill both fields.';
      return;
    }
    postData('http://localhost:3000/login', {username, password})
      .then(res => {
        if(res.message){
          message.style.color = 'lightgreen';
          message.textContent = res.message;
          // On successful login redirect to main site
          setTimeout(()=> window.location.href = 'index.html', 1000);
        } else if(res.error) {
          message.style.color = '#f88';
          message.textContent = res.error;
        }
      })
      .catch(() => {
        message.style.color = '#f88';
        message.textContent = 'Server error';
      });
  };

  registerBtn.onclick = () => {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    if (!username || !password) {
      message.textContent = 'Please fill both fields.';
      return;
    }
    postData('http://localhost:3000/register', {username, password})
      .then(res => {
        if(res.message){
          message.style.color = 'lightgreen';
          message.textContent = res.message + ' You can now login.';
        } else if(res.error) {
          message.style.color = '#f88';
          message.textContent = res.error;
        }
      })
      .catch(() => {
        message.style.color = '#f88';
        message.textContent = 'Server error';
      });
  };
</script>

</body>
</html>
